<?php
namespace Cbi\MalwareChecker\Tests\Unit;

use PHPUnit\Framework\TestCase;
use Cbi\MalwareChecker\Response;
use Cbi\MalwareChecker\MalwareChecker;

class MalwareCheckerTest extends TestCase
{
    protected $checker;
    protected $safeHash;
    protected $infectedHash;

    /**
     * {@inheritdoc}
     */
    public function setUp()
    {
        parent::setUp();
        $this->checker = new MalwareChecker;
        $this->safeHash = 'ebbd225e6fd4eaa7189423a4b17065b3';
        $this->infectedHash = 'f58628917abcbcfb2b2258b6b46bf721';
    }

    /**
     * Test the malware checker check function
     */
    public function testCheckFunctionReturnsArrayOnInfectedHash()
    {
        $infectedResponse = $this->checker->check($this->infectedHash);

        $this->assertTrue(is_array($infectedResponse));
    }

    /**
     * Test the malware checker check function
     */
    public function testCheckFunctionReturnsFalseOnSafeHash()
    {
        $safeResponse = $this->checker->check($this->safeHash);

        $this->assertFalse($safeResponse);
    }

    /**
     * Test the malware checker check function
     */
    public function testCheckManyFunctionOnlyReturnsInfectedHashes()
    {
        $whoisResponse = $this->checker->checkMany([$this->infectedHash, $this->safeHash]);

        $this->assertCount(1, $whoisResponse);
        $this->assertContains($this->infectedHash, $whoisResponse[0]);
    }
}
