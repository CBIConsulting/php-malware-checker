<?php
namespace Cbi\MalwareChecker\Tests\Unit;

use PHPUnit\Framework\TestCase;
use Cbi\MalwareChecker\Response;
use Cbi\MalwareChecker\MalwareChecker;

class MalwareCheckerTest extends TestCase
{
    protected $checker;
    protected $safeHash;
    protected $infectedHash;

    /**
     * {@inheritdoc}
     */
    public function setUp()
    {
        parent::setUp();
        $this->checker = new MalwareChecker;
        $this->safeHash = 'ebbd225e6fd4eaa7189423a4b17065b3';
        $this->infectedHash = 'f58628917abcbcfb2b2258b6b46bf721';
    }

    /**
     * Test the malware checker check function
     */
    public function testCheckFunction()
    {
        $infectedResponse = $this->checker->check($this->infectedHash);
        $this->assertInstanceOf(Response::class, $infectedResponse);
        $safeResponse = $this->checker->check($this->infectedHash);
        $this->assertInstanceOf(Response::class, $safeResponse);
    }
}
